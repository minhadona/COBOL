
--------------
prod|  preco
+---+--------+
|111| 8888800|
|222| 0070000|
|333| 6666600|
|444| 2222250|
|555| 3333300|
|666| 1111100|
|777| 0044450|
|888| 0333350|
|999| 6666650|
+---+--------+

*********************************************************************************************************
PROG1:
le NOTAS.dat e gera PROD.dat e TOTAL.dat

------- nota.dat 
111111333666660044422222505553333300
111111 333 6666600 444 2222250 555 3333300

nota fiscal: 111111 
- produto 333
- preco 66666,00
- produto 444
- preco 22222,50
- produto 555 
- preco 33333,00

------- inicio do registro do prod.dat deve ficar: 
3336666600
4442222250
5553333300

------- primeiro registro do total.dat deve ficar:
111111012222150

correspondente à nota 111111 
precfinal 122.221,5 sendo q antes da virgula fica formatado com 7 digitos
(esse preço eh resultado do prod 1 2 e 3, que no primeiro registro de nota sao os produtos de codigo 333,444 e 555 com preços respectivos 66666,00   22222,50 e 33333,00)

*********************************************************************************************************
PROG2:
le TOTAL.dat e gera REL-TOTAL 

------- primeiro registro do total.dat deve ficar:
111111012222150

------- output no prog 2:
111.111     122.221,50



                   RELATORIO DE TOTAIS POR NOTA FISCAL                 PAG:  1  

             NUMERO DA NOTA                VALOR TOTAL DA NOTA                  

               111.111                          122.221,50                      
               222.222                          111.110,00                      
               333.333                          111.810,50                      
               444.444                          158.887,50                      
               555.555                          100.444,00                      
               666.666                          100.000,00                      
               777.777                          166.665,00                      
               888.888                          122.665,50                      
               999.999                          177.776,50                      
               000.001                           45.144,00                      
               000.002                           92.666,00                      
               000.003                          100.000,00                      
               000.004                          111.555,00                      
               000.005                           70.699,50                      
               000.006                          122.665,50                      
               000.007                          134.032,50                      
               000.008                           90.032,50                      
               000.009                          158.888,00                      
               000.010                          155.998,50                      
               000.011                           78.477,50                      
                   RELATORIO DE TOTAIS POR NOTA FISCAL                 PAG:  2  

             NUMERO DA NOTA                VALOR TOTAL DA NOTA                  

               000.012                           89.589,00                      
               000.013                           70.444,50                      
               000.014                           58.889,00                      
               000.015                           67.811,00                      

          RECEITA TOTAL DE VENDAS:           2.618.467,00                       
          MEDIA DE RECEITA POR VENDA/NOTA FISCAL:   109.102,79                  


*********************************************************************************************************
PROG3:
le PROD.dat e gera RELPROD 

------- inicio do registro do prod.dat deve ficar: 
3336666600

------- output no prog 3:
333  66.666,00


                       RELATORIO DE PRODUTOS                           PAG:  1  

              CODIGO DO PRODUTO               PRECO DO PRODUTO                  

                    333                           66.666,00                     
                    444                           22.222,50                     
                    555                           33.333,00       


*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************

█████████████████████████████████████████████████████████████████████████████████████
█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░░░███░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░███
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀░░███
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░░░██████████░░░░▄▀░░███
█░░▄▀░░██░░▄▀░░█░░▄▀░░████░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░████████████████████░░▄▀░░███
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░████████████████████░░▄▀░░███
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░░░░░████████████░░▄▀░░███
█░░▄▀░░░░░░░░░░█░░▄▀░░░░░░▄▀░░░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░████████████░░▄▀░░███
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█████░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░████████████░░▄▀░░███
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░░░░░█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░▄▀░░██████████░░░░▄▀░░░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀▄▀░░█
█░░░░░░█████████░░░░░░██░░░░░░░░░░█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░░░█
█████████████████████████████████████████████████████████████████████████████████████



      *█████████████████████████████████████████
      *█▄─▄█▄─▄▄▀█▄─▄▄─█▄─▀█▄─▄█─▄─▄─█▄─▄█▄─▄▄─█
      *██─███─██─██─▄█▀██─█▄▀─████─████─███─▄███
      *▀▄▄▄▀▄▄▄▄▀▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▄▄▄▀▀▄▄▄▀▄▄▄▀▀▀
       IDENTIFICATION DIVISION.
       PROGRAM-ID. prog1.
       AUTHOR. GABRIELLA-DESTRO.
       DATE-WRITTEN. 18/06/2020. 
       DATE-COMPILED. 18/06/2020.
      *Este programa le NOTAS.dat e gera PROD.dat e TOTAL.dat

      *████████████████████████████████████
      *█▄─▄▄─█▄─▀█▄─▄█▄─█─▄█▄─▄█▄─▄▄▀█─▄▄─█
      *██─▄█▀██─█▄▀─███▄▀▄███─███─▄─▄█─██─█
      *▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▀▄▀▀▀▄▄▄▀▄▄▀▄▄▀▄▄▄▄▀
       ENVIRONMENT DIVISION.
       SOURCE-COMPUTER. PC.
       OBJECT-COMPUTER. PC. 
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA. 
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT NOTA ASSIGN DISK
           ORGANIZATION IS LINE SEQUENTIAL.
           SELECT PROD ASSIGN DISK       
           ORGANIZATION IS LINE SEQUENTIAL.
           SELECT TOTAL ASSIGN DISK
           ORGANIZATION IS LINE SEQUENTIAL.
 
      *█████████████████████████
      *█▄─▄▄▀██▀▄─██─▄─▄─██▀▄─██
      *██─██─██─▀─████─████─▀─██
      *▀▄▄▄▄▀▀▄▄▀▄▄▀▀▄▄▄▀▀▄▄▀▄▄▀
       DATA DIVISION.
       FILE SECTION.                
               
      *,---.,---.,---.|,---.--.--,---.,---.,---.
      *|---'|--- |  _.|`---.  |  |---'|   |`---.
      *|  \ |    |   ||    |  |  |  \ |   |    |
      *`   ``---'`---'``---'  `  `   ``---'`---'
                                         

       FD NOTA 
       LABEL RECORDS STANDARD
           VALUE OF FILE-ID IS "NOTA.DAT".
       
       01 REG-NOTA.       
           05 NUMNOTA   PIC 9(6).
           05 PROD1     PIC 9(3). 
           05 PRECP1    PIC 9(5)V99.
           05 PROD2     PIC 9(3). 
           05 PRECP2    PIC 9(5)V99.
           05 PROD3     PIC 9(3). 
           05 PRECP3    PIC 9(5)V99.
      *-------------------------------------
       FD PROD 
       LABEL RECORDS STANDARD
           VALUE OF FILE-ID IS "PROD.DAT".

       01 REG-PROD.       
           05 PRODUTO   PIC 9(3).
           05 PRECO     PIC 9(5)V99. 
      *-------------------------------------
       FD TOTAL 
       LABEL RECORDS STANDARD
           VALUE OF FILE-ID IS "TOTAL.DAT".

       01 REG-TOTAL.       
           05 NOTAFISCAL PIC 9(6).
           05 PRECTOTAL  PIC 9(7)V99.

                                                                 
      *. . .,---.,---.|   /|,   .    ,---.--.--,---.,---.,---.,---.,---.
      *| | ||   ||---'|__/ ||\  |    `---.  |  |   ||---'|---||  _.|--- 
      *| | ||   ||  \ |  \ || \ |        |  |  |   ||  \ |   ||   ||    
      *`-'-'`---'`   ``   ```  `'    `---'  `  `---'`   ``   '`---'`---'
                                                                 
       WORKING-STORAGE SECTION.
       77  FIM     PIC X       VALUE SPACES.

      *████████████████████████████████████
      *█▄─▄▄─█▄─▄▄▀█─▄▄─█─▄▄▄─█▄─▄▄─█▄─▄▄▀█
      *██─▄▄▄██─▄─▄█─██─█─███▀██─▄█▀██─██─█
      *▀▄▄▄▀▀▀▄▄▀▄▄▀▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▀▀
       PROCEDURE DIVISION.

       CONTROLE.
       PERFORM ABRIR.
       PERFORM LEITURA.
       PERFORM ROTINA UNTIL FIM EQUAL "*". 
       PERFORM FECHAR. 
       STOP RUN.

       ROTINA.
           PERFORM GRAVAPROD.
           PERFORM GRAVATOTAL.
           PERFORM LEITURA.
       
       ABRIR.
           OPEN INPUT NOTA  OUTPUT PROD TOTAL.

       LEITURA.
           READ NOTA
                 AT END MOVE "*" TO FIM.

       GRAVAPROD.
           MOVE PROD1 TO PRODUTO.
           MOVE PRECP1 TO PRECO.
           WRITE REG-PROD.
           MOVE PROD2 TO PRODUTO.
           MOVE PRECP2 TO PRECO.
           WRITE REG-PROD.
           MOVE PROD3 TO PRODUTO.
           MOVE PRECP3 TO PRECO.
           WRITE REG-PROD.

       GRAVATOTAL. 
           MOVE NUMNOTA TO NOTAFISCAL.
           COMPUTE PRECTOTAL = PRECP1 + PRECP2 + PRECP3.
           WRITE REG-TOTAL.

       FECHAR.
           CLOSE NOTA PROD TOTAL. 
           
 *********************************************************************************************************
 
█████████████████████████████████████████████████████████████████████████████████████████
█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░░░███░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░░░░░░░█
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░░░██████████░░░░░░░░░░▄▀░░█
█░░▄▀░░██░░▄▀░░█░░▄▀░░████░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██████████████████████████░░▄▀░░█
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██████████████████░░░░░░░░░░▄▀░░█
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░░░░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░▄▀░░░░░░░░░░█░░▄▀░░░░░░▄▀░░░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░██████████░░▄▀░░░░░░░░░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█████░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░██████████░░▄▀░░█████████
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░░░░░█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░▄▀░░██████████░░▄▀░░░░░░░░░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░░░░░█████████░░░░░░██░░░░░░░░░░█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░░░░░░░█
█████████████████████████████████████████████████████████████████████████████████████████



      *█████████████████████████████████████████
      *█▄─▄█▄─▄▄▀█▄─▄▄─█▄─▀█▄─▄█─▄─▄─█▄─▄█▄─▄▄─█
      *██─███─██─██─▄█▀██─█▄▀─████─████─███─▄███
      *▀▄▄▄▀▄▄▄▄▀▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▄▄▄▀▀▄▄▄▀▄▄▄▀▀▀
       IDENTIFICATION DIVISION.
       PROGRAM-ID. prog2.
       AUTHOR. GABRIELLA-DESTRO.
       DATE-WRITTEN. 18/06/2020. 
       DATE-COMPILED. 18/06/2020.
      *Este programa le TOTAL.dat e gera REL-TOTAL 

      *████████████████████████████████████
      *█▄─▄▄─█▄─▀█▄─▄█▄─█─▄█▄─▄█▄─▄▄▀█─▄▄─█
      *██─▄█▀██─█▄▀─███▄▀▄███─███─▄─▄█─██─█
      *▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▀▄▀▀▀▄▄▄▀▄▄▀▄▄▀▄▄▄▄▀
       ENVIRONMENT DIVISION.
       SOURCE-COMPUTER. PC.
       OBJECT-COMPUTER. PC. 
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA. 
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT TOTAL ASSIGN DISK
           ORGANIZATION IS LINE SEQUENTIAL.
           SELECT RELTOTAL ASSIGN DISK.

      *█████████████████████████
      *█▄─▄▄▀██▀▄─██─▄─▄─██▀▄─██
      *██─██─██─▀─████─████─▀─██
      *▀▄▄▄▄▀▀▄▄▀▄▄▀▀▄▄▄▀▀▄▄▀▄▄▀
       DATA DIVISION.
       FILE SECTION.

      *,---.,---.,---.|,---.--.--,---.,---.,---.
      *|---'|--- |  _.|`---.  |  |---'|   |`---.
      *|  \ |    |   ||    |  |  |  \ |   |    |
      *`   ``---'`---'``---'  `  `   ``---'`---'
                                         
       FD TOTAL 
       LABEL RECORDS STANDARD
           VALUE OF FILE-ID IS "TOTAL.DAT".

       01 REG-TOTAL.       
           05 NOTAFISCAL PIC 9(6).
           05 PRECTOTAL  PIC 9(7)V99.
      *-----------------------------------
       FD RELTOTAL 
       LABEL RECORDS OMITTED.
       
       01 REGPRINT PIC X(80). 
                                                    
      *. . .,---.,---.|   /|,   .    ,---.--.--,---.,---.,---.,---.,---.
      *| | ||   ||---'|__/ ||\  |    `---.  |  |   ||---'|---||  _.|--- 
      *| | ||   ||  \ |  \ || \ |        |  |  |   ||  \ |   ||   ||    
      *`-'-'`---'`   ``   ```  `'    `---'  `  `---'`   ``   '`---'`---'

       WORKING-STORAGE SECTION.
       77  FIM     PIC X       VALUE SPACES.
       77  CT-LIN  PIC 9(02)   VALUE 21.  
       77  RECEITA PIC 9(09)V99   VALUE ZEROS.
       77  PAGINA  PIC 9(02) VALUE ZEROS.
       77  CT-NOTA PIC 9(03)  VALUE ZEROS.
       77  AVG-NOTA PIC 9(07)V99 VALUE ZEROS.

      *,---.,---.,---.,---.,---.,---.|    |   |,---.,---.
      *|    |---||---.|--- |    |---||    |---||   |`---.
      *|    |   ||   ||    |    |   ||    |   ||   |    |
      *`---'`   '`---'`---'`---'`   '`---'`   '`---'`---'

      * DESIGN REL-TOTAL
       01  CAB-TOTAL-L1.
           05   FILLER       PIC X(19)      VALUE SPACES.
           05   FILLER       PIC X(35)      VALUE 
          "RELATORIO DE TOTAIS POR NOTA FISCAL". 
           05   FILLER       PIC X(17)      VALUE SPACES. 
           05   FILLER       PIC  X(05)     VALUE   "PAG: ".
           05   PAGINA-TOTAL PIC  Z9        VALUE ZEROS. 
           05   FILLER       PIC X(2)       VALUE SPACES.

       01  CAB-TOTAL-L2.
           05   FILLER       PIC X(13)      VALUE SPACES.
           05   FILLER       PIC X(14)      VALUE "NUMERO DA NOTA".
           05   FILLER       PIC X(16)      VALUE SPACES.
           05   FILLER       PIC X(19)      VALUE "VALOR TOTAL DA NOTA".
           05   FILLER       PIC X(18)      VALUE SPACES.

       01  CAB-TOTAL-DET-L1. 
           05   FILLER       PIC X(15)         VALUE SPACES.  
           05   NUM-NOTA     PIC 999.999       VALUE ZEROS. 
           05   FILLER       PIC X(24)         VALUE SPACES.
           05   VALOR-NOTA   PIC Z.ZZZ.ZZ9,99  VALUE ZEROS.
           05   FILLER       PIC X(22)         VALUE SPACES.

       01  CAB-TOTAL-DET-RODAPE.
           05  FILLER   PIC X(10) VALUE SPACES.
           05  FILLER   PIC X(25) VALUE "RECEITA TOTAL DE VENDAS: ".
           05  RECEITA-DET   PIC ZZZ.ZZZ.ZZZ.ZZZ.ZZ9,99 VALUE ZEROS.
           05  FILLER   PIC X(23) VALUE SPACES.

       02  CAB-MEDIA-DET-RODAPE.
           05  FILLER   PIC X(10) VALUE SPACES.
           05  FILLER   PIC X(40) VALUE 
           "MEDIA DE RECEITA POR VENDA/NOTA FISCAL: ".
           05  MEDIA-DET PIC Z.ZZZ.Z99,99 VALUE ZEROS.
           05  FILLER   PIC X(18) VALUE SPACES.

      *████████████████████████████████████
      *█▄─▄▄─█▄─▄▄▀█─▄▄─█─▄▄▄─█▄─▄▄─█▄─▄▄▀█
      *██─▄▄▄██─▄─▄█─██─█─███▀██─▄█▀██─██─█
      *▀▄▄▄▀▀▀▄▄▀▄▄▀▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▀▀
       PROCEDURE DIVISION.

       CONTROLE.
       PERFORM ABRIR.
       PERFORM LEITURA.
       PERFORM ROTINA UNTIL FIM EQUAL "*". 
       PERFORM RODAPE.
       PERFORM FECHAR. 
       STOP RUN.


       ABRIR.
           OPEN INPUT TOTAL  OUTPUT RELTOTAL.

       LEITURA.
           READ TOTAL
                 AT END MOVE "*" TO FIM. 
        

       ROTINA.
           PERFORM IMPRESSAO.
           PERFORM LEITURA.
        

       IMPRESSAO. 
           IF (CT-LIN GREATER 20) 
              ADD 1 TO PAGINA
              MOVE PAGINA TO PAGINA-TOTAL
              WRITE REGPRINT FROM CAB-TOTAL-L1 AFTER ADVANCING PAGE 
              WRITE REGPRINT FROM CAB-TOTAL-L2 AFTER ADVANCING 2 LINE
              MOVE 1 TO CT-LIN

           ELSE NEXT SENTENCE.

           ADD 1 TO CT-NOTA.       
           ADD PRECTOTAL TO RECEITA.
           MOVE NOTAFISCAL TO NUM-NOTA.
           MOVE PRECTOTAL TO VALOR-NOTA.

           IF (CT-LIN EQUAL TO 1) 
              WRITE REGPRINT FROM CAB-TOTAL-DET-L1 AFTER ADVANCING
              2 LINES
           ELSE 
              WRITE REGPRINT FROM CAB-TOTAL-DET-L1 AFTER ADVANCING 
              1 LINE.

            ADD 1 TO CT-LIN. 


       RODAPE.
           MOVE RECEITA TO RECEITA-DET.
           WRITE REGPRINT FROM CAB-TOTAL-DET-RODAPE AFTER ADVANCING
           2 LINES. 
           
           COMPUTE AVG-NOTA = RECEITA/CT-NOTA. 
           MOVE AVG-NOTA TO MEDIA-DET.
           WRITE REGPRINT FROM CAB-MEDIA-DET-RODAPE AFTER ADVANCING 
           1 LINE.

       FECHAR.
           CLOSE TOTAL RELTOTAL. 
           
*********************************************************************************************************

█████████████████████████████████████████████████████████████████████████████████████████
█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░░░███░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░░░░░░░█
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░░░██████████░░░░░░░░░░▄▀░░█
█░░▄▀░░██░░▄▀░░█░░▄▀░░████░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██████████████████████████░░▄▀░░█
█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░░░▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██████████████████░░░░░░░░░░▄▀░░█
█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀▄▀░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░░░░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░▄▀░░░░░░░░░░█░░▄▀░░░░░░▄▀░░░░███░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░██████████░░░░░░░░░░▄▀░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░█████░░▄▀░░██░░▄▀░░█░░▄▀░░██░░▄▀░░██████████████████░░▄▀░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀░░░░░░█░░▄▀░░░░░░▄▀░░█░░▄▀░░░░░░▄▀░░██████████░░░░░░░░░░▄▀░░█
█░░▄▀░░█████████░░▄▀░░██░░▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░█░░▄▀▄▀▄▀▄▀▄▀░░██████████░░▄▀▄▀▄▀▄▀▄▀░░█
█░░░░░░█████████░░░░░░██░░░░░░░░░░█░░░░░░░░░░░░░░█░░░░░░░░░░░░░░██████████░░░░░░░░░░░░░░█
█████████████████████████████████████████████████████████████████████████████████████████

 
      *█████████████████████████████████████████
      *█▄─▄█▄─▄▄▀█▄─▄▄─█▄─▀█▄─▄█─▄─▄─█▄─▄█▄─▄▄─█
      *██─███─██─██─▄█▀██─█▄▀─████─████─███─▄███
      *▀▄▄▄▀▄▄▄▄▀▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▄▄▄▀▀▄▄▄▀▄▄▄▀▀▀ 
       IDENTIFICATION DIVISION.
       PROGRAM-ID. prog3.
       AUTHOR. GABRIELLA-DESTRO.
       DATE-WRITTEN. 18/06/2020. 
       DATE-COMPILED. 18/06/2020.
      *Este programa le PROD.dat e gera RELPROD 

      *████████████████████████████████████
      *█▄─▄▄─█▄─▀█▄─▄█▄─█─▄█▄─▄█▄─▄▄▀█─▄▄─█
      *██─▄█▀██─█▄▀─███▄▀▄███─███─▄─▄█─██─█
      *▀▄▄▄▄▄▀▄▄▄▀▀▄▄▀▀▀▄▀▀▀▄▄▄▀▄▄▀▄▄▀▄▄▄▄▀

       ENVIRONMENT DIVISION.
       SOURCE-COMPUTER. PC.
       OBJECT-COMPUTER. PC. 
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA. 
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT PROD ASSIGN DISK
           ORGANIZATION IS LINE SEQUENTIAL.
           SELECT RELPROD ASSIGN DISK.

      *█████████████████████████
      *█▄─▄▄▀██▀▄─██─▄─▄─██▀▄─██
      *██─██─██─▀─████─████─▀─██
      *▀▄▄▄▄▀▀▄▄▀▄▄▀▀▄▄▄▀▀▄▄▀▄▄▀
       DATA DIVISION.
       FILE SECTION.

      *,---.,---.,---.|,---.--.--,---.,---.,---.
      *|---'|--- |  _.|`---.  |  |---'|   |`---.
      *|  \ |    |   ||    |  |  |  \ |   |    |
      *`   ``---'`---'``---'  `  `   ``---'`---'
                                         
       FD PROD 
       LABEL RECORDS STANDARD
           VALUE OF FILE-ID IS "PROD.DAT".

       01 REG-PROD.       
           05 PRODUTO   PIC 9(3).
           05 PRECO     PIC 9(5)V99. 

      *-----------------------------------
       FD RELPROD 
       LABEL RECORDS OMITTED.
       
       01 REGPRINT PIC X(80). 
                                         
      *. . .,---.,---.|   /|,   .    ,---.--.--,---.,---.,---.,---.,---.
      *| | ||   ||---'|__/ ||\  |    `---.  |  |   ||---'|---||  _.|--- 
      *| | ||   ||  \ |  \ || \ |        |  |  |   ||  \ |   ||   ||    
      *`-'-'`---'`   ``   ```  `'    `---'  `  `---'`   ``   '`---'`---'

       WORKING-STORAGE SECTION.
       77  FIM     PIC X       VALUE SPACES.
       77  CT-LIN  PIC 9(02)   VALUE 21.  
       77  PAGINA  PIC 9(02) VALUE ZEROS.

      *,---.,---.,---.,---.,---.,---.|    |   |,---.,---.
      *|    |---||---.|--- |    |---||    |---||   |`---.
      *|    |   ||   ||    |    |   ||    |   ||   |    |
      *`---'`   '`---'`---'`---'`   '`---'`   '`---'`---'

      * DESIGN REL-PROD 
       01  CAB-PROD-L1.
           05    FILLER   PIC  X(23)     VALUE    SPACES.
           05    FILLER   PIC  X(21)     VALUE   
           "RELATORIO DE PRODUTOS".
           05    FILLER   PIC  X(27)     VALUE    SPACES.
           05    FILLER   PIC  X(05)     VALUE   "PAG: ".
           05    PAGINA-PROD  PIC  Z9        VALUE   ZEROS.
           05    FILLER   PIC  X(04)     VALUE   SPACES.   

       01  CAB-PROD-L2.
           05   FILLER    PIC X(14)      VALUE SPACES. 
           05   FILLER    PIC X(17)      VALUE "CODIGO DO PRODUTO".
           05   FILLER    PIC X(15)      VALUE SPACES.
           05   FILLER    PIC X(16)      VALUE "PRECO DO PRODUTO".
           05   FILLER    PIC X(20)      VALUE SPACES. 

       01  CAB-PROD-DET-L1.
           05   FILLER    PIC X(20)      VALUE SPACES.
           05   CODPROD   PIC 999        VALUE ZEROS. 
           05   FILLER    PIC X(27)      VALUE SPACES.
           05   PRECOPROD PIC ZZ.ZZ9,99  VALUE ZEROS.
           05   FILLER    PIC X(23)      VALUE SPACES.                     


      *████████████████████████████████████
      *█▄─▄▄─█▄─▄▄▀█─▄▄─█─▄▄▄─█▄─▄▄─█▄─▄▄▀█
      *██─▄▄▄██─▄─▄█─██─█─███▀██─▄█▀██─██─█
      *▀▄▄▄▀▀▀▄▄▀▄▄▀▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▄▀▄▄▄▄▀▀
       PROCEDURE DIVISION.

       CONTROLE.
       PERFORM ABRIR.
       PERFORM LEITURA.
       PERFORM ROTINA UNTIL FIM EQUAL "*". 
       PERFORM FECHAR. 
       STOP RUN.


       ABRIR.
           OPEN INPUT PROD  OUTPUT RELPROD.

       LEITURA.
           READ PROD
                 AT END MOVE "*" TO FIM. 
        

       ROTINA.
           PERFORM IMPRESSAO.
           PERFORM LEITURA.

       IMPRESSAO. 
           IF (CT-LIN GREATER 20) 
              ADD 1 TO PAGINA
              MOVE PAGINA TO PAGINA-PROD
              WRITE REGPRINT FROM CAB-PROD-L1 AFTER ADVANCING PAGE 
              WRITE REGPRINT FROM CAB-PROD-L2 AFTER ADVANCING 2 LINE
              MOVE 1 TO CT-LIN

           ELSE NEXT SENTENCE.

           MOVE PRODUTO TO CODPROD.
           MOVE PRECO TO PRECOPROD.

           IF (CT-LIN EQUAL TO 1) 
              WRITE REGPRINT FROM CAB-PROD-DET-L1 AFTER ADVANCING
              2 LINES
           ELSE 
              WRITE REGPRINT FROM CAB-PROD-DET-L1 AFTER ADVANCING 
              1 LINE.

            ADD 1 TO CT-LIN.         

       FECHAR.
           CLOSE PROD RELPROD. 


*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************
*********************************************************************************************************

massa original 
NOTAS.DAT
111111333666660044422222505553333300
222222333666660066611111005553333300
333333444222225011188888002220070000
444444111888880088803333503336666600
555555999666665055533333007770044450
666666444222225099966666506661111100
777777333666660066611111001118888800
888888555333330077700444501118888800
999999111888880044422222503336666600
000001555333330066611111002220070000
000002888033335077700444501118888800
000003999666665066611111004442222250
000004444222225011188888007770044450
000005333666660088803333502220070000
000006111888880077700444505553333300
000007222007000033366666009996666650
000008777004445022200700001118888800
000009111888880088803333509996666650
000010333666660077700444501118888800
000011999666665022200700006661111100
000012444222225099966666502220070000
000013888033335077700444509996666650
000014444222225055533333008880333350
000015999666665022200700007770044450

*********************************************************************************************************
PROD.DAT

3336666600
4442222250
5553333300
3336666600
6661111100
5553333300
4442222250
1118888800
2220070000
1118888800
8880333350
3336666600
9996666650
5553333300
7770044450
4442222250
9996666650
6661111100
3336666600
6661111100
1118888800
5553333300
7770044450
1118888800
1118888800
4442222250
3336666600
5553333300
6661111100
2220070000
8880333350
7770044450
1118888800
9996666650
6661111100
4442222250
4442222250
1118888800
7770044450
3336666600
8880333350
2220070000
1118888800
7770044450
5553333300
2220070000
3336666600
9996666650
7770044450
2220070000
1118888800
1118888800
8880333350
9996666650
3336666600
7770044450
1118888800
9996666650
2220070000
6661111100
4442222250
9996666650
2220070000
8880333350
7770044450
9996666650
4442222250
5553333300
8880333350
9996666650
2220070000
7770044450

*********************************************************************************************************
TOTAL.DAT

111111012222150
222222011111000
333333011181050
444444015888750
555555010044400
666666010000000
777777016666500
888888012266550
999999017777650
000001004514400
000002009266600
000003010000000
000004011155500
000005007069950
000006012266550
000007013403250
000008009003250
000009015888800
000010015599850
000011007847750
000012008958900
000013007044450
000014005888900
000015006781100

*********************************************************************************************************
RELPROD 

                       RELATORIO DE PRODUTOS                           PAG:  1  

              CODIGO DO PRODUTO               PRECO DO PRODUTO                  

                    333                           66.666,00                     
                    444                           22.222,50                     
                    555                           33.333,00                     
                    333                           66.666,00                     
                    666                           11.111,00                     
                    555                           33.333,00                     
                    444                           22.222,50                     
                    111                           88.888,00                     
                    222                              700,00                     
                    111                           88.888,00                     
                    888                            3.333,50                     
                    333                           66.666,00                     
                    999                           66.666,50                     
                    555                           33.333,00                     
                    777                              444,50                     
                    444                           22.222,50                     
                    999                           66.666,50                     
                    666                           11.111,00                     
                    333                           66.666,00                     
                    666                           11.111,00                     
                       RELATORIO DE PRODUTOS                           PAG:  2  

              CODIGO DO PRODUTO               PRECO DO PRODUTO                  

                    111                           88.888,00                     
                    555                           33.333,00                     
                    777                              444,50                     
                    111                           88.888,00                     
                    111                           88.888,00                     
                    444                           22.222,50                     
                    333                           66.666,00                     
                    555                           33.333,00                     
                    666                           11.111,00                     
                    222                              700,00                     
                    888                            3.333,50                     
                    777                              444,50                     
                    111                           88.888,00                     
                    999                           66.666,50                     
                    666                           11.111,00                     
                    444                           22.222,50                     
                    444                           22.222,50                     
                    111                           88.888,00                     
                    777                              444,50                     
                    333                           66.666,00                     
                       RELATORIO DE PRODUTOS                           PAG:  3  

              CODIGO DO PRODUTO               PRECO DO PRODUTO                  

                    888                            3.333,50                     
                    222                              700,00                     
                    111                           88.888,00                     
                    777                              444,50                     
                    555                           33.333,00                     
                    222                              700,00                     
                    333                           66.666,00                     
                    999                           66.666,50                     
                    777                              444,50                     
                    222                              700,00                     
                    111                           88.888,00                     
                    111                           88.888,00                     
                    888                            3.333,50                     
                    999                           66.666,50                     
                    333                           66.666,00                     
                    777                              444,50                     
                    111                           88.888,00                     
                    999                           66.666,50                     
                    222                              700,00                     
                    666                           11.111,00                     
                       RELATORIO DE PRODUTOS                           PAG:  4  

              CODIGO DO PRODUTO               PRECO DO PRODUTO                  

                    444                           22.222,50                     
                    999                           66.666,50                     
                    222                              700,00                     
                    888                            3.333,50                     
                    777                              444,50                     
                    999                           66.666,50                     
                    444                           22.222,50                     
                    555                           33.333,00                     
                    888                            3.333,50                     
                    999                           66.666,50                     
                    222                              700,00                     
                    777                              444,50                     

*********************************************************************************************************
RELTOTAL

                   RELATORIO DE TOTAIS POR NOTA FISCAL                 PAG:  1  

             NUMERO DA NOTA                VALOR TOTAL DA NOTA                  

               111.111                          122.221,50                      
               222.222                          111.110,00                      
               333.333                          111.810,50                      
               444.444                          158.887,50                      
               555.555                          100.444,00                      
               666.666                          100.000,00                      
               777.777                          166.665,00                      
               888.888                          122.665,50                      
               999.999                          177.776,50                      
               000.001                           45.144,00                      
               000.002                           92.666,00                      
               000.003                          100.000,00                      
               000.004                          111.555,00                      
               000.005                           70.699,50                      
               000.006                          122.665,50                      
               000.007                          134.032,50                      
               000.008                           90.032,50                      
               000.009                          158.888,00                      
               000.010                          155.998,50                      
               000.011                           78.477,50                      
                   RELATORIO DE TOTAIS POR NOTA FISCAL                 PAG:  2  

             NUMERO DA NOTA                VALOR TOTAL DA NOTA                  

               000.012                           89.589,00                      
               000.013                           70.444,50                      
               000.014                           58.889,00                      
               000.015                           67.811,00                      

          RECEITA TOTAL DE VENDAS:           2.618.473,00                       
          MEDIA DE RECEITA POR VENDA/NOTA FISCAL:   109.103,04                  



/// fontes com
https://www.messletters.com/pt/big-text/
https://fsymbols.com/generators/tarty/
